# Проект hackathonSolver

[![Python](https://img.shields.io/badge/-Python-464646?style=flat-square&logo=Python)](https://www.python.org/)
[![Django](https://img.shields.io/badge/-Django-464646?style=flat-square&logo=Django)](https://www.djangoproject.com/)
[![Django REST Framework](https://img.shields.io/badge/-Django%20REST%20Framework-464646?style=flat-square&logo=Django%20REST%20Framework)](https://www.django-rest-framework.org/)

Здесь расположена краткая документация по API проекта.

## Подготовка к работе

### Склонируйте репозиторий себе на локальную машину

```
git clone https://github.com/Clever001/hackathonSolver.git
```

### Установите требуемые пакеты

Для работы проекта требуется установить Django и Django REST Framework

```
pip install -r requirements.txt
```

### Сделайте миграции

Откройте терминал, перейдите в каталог проекта. После перейдите в каталог djangoApi

```
cd djangoApi
```

Дальше вам требуется создать свою базу данных. Для этого необходимо провести миграции при помощи следующих команд:

```
python manage.py makemigrations
```

```
python manage.py migrate
```

### Создайте супер пользователя с особыми правами

Для этого служит определенная команда.

```
python manage.py createsuperuser
```

Далее вам нужно будет следовать указанием, отображаемым в консоли.

### Запуск сервера

```
python manage.py runserver
```

## Документация

Для того, чтобы выполнить тот или иной запрос пользователь должен быть идентифицирован в системе, чтобы можно было понять какие пара у него есть, а каких нет. 
Для того, чтобы каждый раз при отправлении запроса не нужно было вводить username и password каждому пользователю выдается token, который нужно будет вводить в заголовке запроса.

### Запрос api-token-auth (получение токена пользователя)

Чтобы получить токен пользователя сам пользователь уже должен быть создан на момент отправки данного запроса. Требуется ввести username и password пользователя. Иммейте ввиду, что username всех пользователей должны быть уникальными.

```
url: http://127.0.0.1:8000/api/api-token-auth/
methods: POST-request
```

Пример запроса:

```
{
    "username": "Alex",
    "password": "z12345678"
}
```

Пример ответа: (status: 200 OK)

```
{
    "token": "3fb3a7ef44aef0799ae0459a5b4be7e6ed8cd461"
}
```

В случае, если пользователя с данным username и password не будет ответ будет следующим: (status: 400 Bad Request)

```
{
    "non_field_errors": [
        "Unable to log in with provided credentials."
    ]
}
```

### Пример указания токена пользователя

Данные должны указываться в headers запроса.

```
Key: "Authorization",
Value: "Token 3fb3a7ef44aef0799ae0459a5b4be7e6ed8cd461"
```

### Запрос user-list

При помощи данного запроса можно как создавать пользователей, так и просматривать всех пользователей. При этом разрешение на просмотр данных пользователей выдается только супер пользователю. Создавать пользователей разщрешается и не индентифицированным пользователям.

Для данного и последующих в документации запросов требуется указать токен пользователя, выполняющего запрос.

```
url: http://127.0.0.1:8000/api/user/
methods: GET-request, POST-request
```

#### Пример создания пользователя: (POST)

Обязательные поля: username, password. 
Необязательные поля: first_name, last_name, email.

```
{
    "username": "Alexx",
    "password": "z12345678"
}
```

Пример ответа: (status: 200 OK)

```
{
    "id": 5,
    "username": "Alexx",
    "last_name": "",
    "first_name": "",
    "email": "",
    "token": "ca26ed00293c74cb6b46bd4cdcf07762d830fbc8"
}
```

Если такой username уже существует, ответ будет следующим: (status: 400 Bad Request)

```
{
    "username": [
        "A user with that username already exists."
    ]
}
```

#### Пример получения списка пользователей: (GET)

Тут не требуется указывать какой-либо body у запроса. Разрешается смотреть информацию о пользователях только супер пользователю. Но при этом не показываются пароли. Далее идет пример ответа:

```
[
    {
        "id": 1,
        "username": "ADMIN",
        "first_name": "",
        "last_name": "",
        "email": "",
        "is_superuser": true,
        "date_joined": "2024-06-12T16:44:03.423223+05:00"
    },
    {
        "id": 2,
        "username": "Alex",
        "first_name": "",
        "last_name": "",
        "email": "",
        "is_superuser": false,
        "date_joined": "2024-06-12T16:46:10.307862+05:00"
    },
    {
        "id": 5,
        "username": "Alexx",
        "first_name": "",
        "last_name": "",
        "email": "",
        "is_superuser": false,
        "date_joined": "2024-06-13T12:30:35.889882+05:00"
    }
]
```

### Запрос user-detail

Служит для взаимодействия с конкретным пользователем.

```
url: http://127.0.0.1:8000/api/user/<user_id:int>/
methods: GET-request, DELETE-request
```

Служит для просмотра данных конкретного пользователя или удаления самого пользователя. При этом обычным пользователям разрешается смотреть информацию только о себе.

Пример ошибки прав пользователя: (status: 403 Forbidden)

```
{
    "detail": "You do not have permission to perform this action."
}
```

### Запрос request-content

Служит для отправки и получения текстовых запросов пользователя. Каждый пользователь может просматривать только свои запросы.

```
url: http://127.0.0.1:8000/api/request_content/
methods: GET, POST
```

#### Пример создания пользовательского запроса: (POST)

```
{
    "content": "Как включить компьютер?"
}
```

Пример ответа:

```
{
    "id": 5,
    "content": "Как включить компьютер?",
    "created": "2024-06-13T12:50:38.803587+05:00",
    "author": 2,
    "scope": null
}
```

#### Пример получения пользовательских запросов: (GET)

Ответ сервера: (status: 200 OK)

```
[
    {
        "id": 1,
        "content": "Как включить интернет?",
        "created": "2024-06-12T16:50:21.177261+05:00",
        "author": 2,
        "scope": 2
    },
    {
        "id": 2,
        "content": "Как включить компьютер?",
        "created": "2024-06-12T16:57:39.196751+05:00",
        "author": 2,
        "scope": 2
    },
    {
        "id": 3,
        "content": "Как включить компьютер соседа?",
        "created": "2024-06-12T18:52:58.783072+05:00",
        "author": 2,
        "scope": 1
    }
]
```

#### Для получения и удаления данных конкретного запроса в url требуется указать id запроса, как это показано в запросе user-detail

### Запрос tokenize

Данный запрос служит для запуска токенизации конкретного запроса. Не запускайте токенизацию одного и того же запроса дважды!!!

```
url: http://127.0.0.1:8000/api/tokenize/request_id/
methods: POST
```

Пример ответа: (status: 201 created)

```
[
    "Как",
    "включить",
    "компьютер?"
]
```

### Запрос Classify

Данный запрос служит для классификации конкретного запроса. Сначала требуется запустить токенизацию запроса, иначе сервер выведет ошибку.

```
url: http://127.0.0.1:8000/api/classify/request_id/
methods: POST
```

Пример ответа на классификацию не токенизированного запроса: (status: 400 Bad Request)

```
{
    "message": "Request is not tokenized"
}
```

Пример ответа на классификацию токенизированного запроса: (status: 201 Created)

```
{
    "id": 5,
    "content": "Как включить компьютер?",
    "created": "2024-06-13T12:50:38.803587+05:00",
    "author": 2,
    "scope": 2
}
```

### Запрос Scope

Данный запрос служит для получения, удаления областей вопросов. Предполагается, что в бд они все были записаны заранее. От фронта требуется только получить название конкретной области по айдишнику.

```
url: http://127.0.0.1:8000/api/scope/<scope_id:int>/
methods: GET
```

Ответ: (status: 200 OK)

```
{
    "id": 1,
    "name": "Проблема с интернетом"
}
```

### Запрос GetAnswers

Данный запрос служит для получения всех ответов из заданной области вопросов. Разрешается выполнять всем индентифицированным пользователям.

```
url: http://127.0.0.1:8000/api/answers/<scope_id:int>/
methods: GET
```

Пример ответа: (status: 200 OK)

```
[
    {
        "id": 1,
        "question": "Example question.",
        "answer": "Example Answer.",
        "scope": 1
    },
    {
        "id": 4,
        "question": "Example question4.",
        "answer": "Example Answer4.",
        "scope": 1
    }
]
```

## Дополнительные запросы

### Запрос doc_answer

Данный запрос разрешается выполнять только супер пользователю.

Служит для записи в бд и удаление из бд документации. Также тут разрешается простотр отдельной записи. Для этого только требуется ввести id экземпляра doc_answer. Сначала требуется добавить scope, после чего объязательно указать scope_id в запросе doc_answer

```
url: http://127.0.0.1:8000/api/doc_answer/
methods: GET, POST, DELETE
```

### Запрос Scope

Данный запрос служит для просмотре и создания сфер областей вопросов.

```
url: http://127.0.0.1:8000/api/scope/
methods: GET, POST, DELETE
```
